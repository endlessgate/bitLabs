
from labs.exceptions import (
    InvalidKeys,
    PayloadError
)

a = b'\x04<m)>4\xf3tX@\x15\x14R\x9a\xe0B`A\xc9\xd0\xf9.\x1b/\xf7M1\xa0C\xc2xE\xed\xa3]\xd8K\x11\xdaX~\x7f\xa0\x9b\xdc\xcdb_-\x91}Lhv\x8d\xee\r\xdb%@\xfe44\x9a\xb1\x0fDtp\x17+\xa8\xaap\xb5\xbe\x822\x7f\xde\x80#\x15\x1b\xed\xa0\xa5Z\x9a\xd6\xb1\x9a\xa8\xf3\xfb\xa71\x00\x00\x00\x15\x1d\xf7!D?\xa9-\xc1\x95\xbda\xdf\xa7p&\n\xdeF\xbf\x06\x94'


def decrypt(privkey: bytes, data: bytes, shared=b'') -> bytes:
    if data[:1] != b'\x04':
        raise PayloadError("unexpected header")

    enter_shared = data[:66]


